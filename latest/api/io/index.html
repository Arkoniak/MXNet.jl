<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Data Providers - MXNet.jl</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="MXNet.jl">
    <meta property="og:image" content="None/../../">
    <meta name="apple-mobile-web-app-title" content="MXNet.jl">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-a422ff04cc.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../assets/Documenter.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-indigo palette-accent-blue">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                API Documentation <i class="icon icon-link"></i>
              
            
          </span>
        
        Data Providers
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/dmlc/MXNet.jl" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          MXNet.jl
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          dmlc/MXNet.jl
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/dmlc/MXNet.jl/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/dmlc/MXNet.jl/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Tutorial</span>
    <ul>
      
        
  <li>
    <a class="" title="Digit Recognition on MNIST" href="../../tutorial/mnist/">
      Digit Recognition on MNIST
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Generating Random Sentence with LSTM RNN" href="../../tutorial/char-lstm/">
      Generating Random Sentence with LSTM RNN
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">User Guide</span>
    <ul>
      
        
  <li>
    <a class="" title="Installation Guide" href="../../user-guide/install/">
      Installation Guide
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Overview" href="../../user-guide/overview/">
      Overview
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="FAQ" href="../../user-guide/faq/">
      FAQ
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">API Documentation</span>
    <ul>
      
        
  <li>
    <a class="" title="Context" href="../context/">
      Context
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Models" href="../model/">
      Models
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Initializers" href="../initializer/">
      Initializers
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Optimizers" href="../optimizer/">
      Optimizers
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Callbacks in training" href="../callback/">
      Callbacks in training
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Evaluation Metrics" href="../metric/">
      Evaluation Metrics
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="Data Providers" href="./">
      Data Providers
    </a>
    
      
        
      
      
    
  </li>

      
        
  <li>
    <a class="" title="NDArray API" href="../ndarray/">
      NDArray API
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Symbolic API" href="../symbolic-node/">
      Symbolic API
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Neural Networks Factory" href="../nn-factory/">
      Neural Networks Factory
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Executor" href="../executor/">
      Executor
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Network Visualization" href="../visualize/">
      Network Visualization
    </a>
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <p><a id='Data-Providers-1'></a></p>
<h1 id="data-providers">Data Providers</h1>
<p>Data providers are wrappers that load external data, be it images, text, or general tensors, and split it into mini-batches so that the model can consume the data in a uniformed way.</p>
<p><a id='MXNet.mx.AbstractDataBatch' href='#MXNet.mx.AbstractDataBatch'>#</a>
<strong><code>MXNet.mx.AbstractDataBatch</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>AbstractDataBatch
</code></pre>

<p>Base type for a data mini-batch. It should implement the following interfaces:</p>
<pre><code>   count_samples(provider, batch) -&gt; Int

  :param AbstractDataBatch batch: the data batch object.
  :return: the number of samples in this batch. This number should be greater than 0, but
           less than or equal to the batch size. This is used to indicate at the end of
           the data set, there might not be enough samples for a whole mini-batch.

   get_data(provider, batch) -&gt; Vector{NDArray}

  :param AbstractDataProvider provider: the data provider.
  :param AbstractDataBatch batch: the data batch object.
  :return: a vector of data in this batch, should be in the same order as declared in
           :func:`provide_data() &lt;AbstractDataProvider.provide_data&gt;`.

           The last dimension of each :class:`NDArray` should always match the batch_size, even when
           :func:`count_samples` returns a value less than the batch size. In this case,
           the data provider is free to pad the remaining contents with any value.

   get_label(provider, batch) -&gt; Vector{NDArray}

  :param AbstractDataProvider provider: the data provider.
  :param AbstractDataBatch batch: the data batch object.
  :return: a vector of labels in this batch. Similar to :func:`get_data`.
</code></pre>

<p>The following utility functions will be automatically defined.</p>
<pre><code>   get(provider, batch, name) -&gt; NDArray

  :param AbstractDataProvider provider: the data provider.
  :param AbstractDataBatch batch: the data batch object.
  :param Base.Symbol name: the name of the data to get, should be one of the names
         provided in either :func:`provide_data() &lt;AbstractDataProvider.provide_data&gt;`
         or :func:`provide_label() &lt;AbstractDataProvider.provide_label&gt;`.
  :return: the corresponding data array corresponding to that name.

   load_data!(provider, batch, targets)

  :param AbstractDataProvider provider: the data provider.
  :param AbstractDataBatch batch: the data batch object.
  :param targets: the targets to load data into.
  :type targets: Vector{Vector{SlicedNDArray}}

  The targets is a list of the same length as number of data provided by this provider.
  Each element in the list is a list of :class:`SlicedNDArray`. This list described a
  spliting scheme of this data batch into different slices, each slice is specified by
  a slice-ndarray pair, where *slice* specify the range of samples in the mini-batch
  that should be loaded into the corresponding *ndarray*.

  This utility function is used in data parallelization, where a mini-batch is splited
  and computed on several different devices.

   load_label!(provider, batch, targets)

  :param AbstractDataProvider provider: the data provider.
  :param AbstractDataBatch batch: the data batch object.
  :param targets: the targets to load label into.
  :type targets: Vector{Vector{SlicedNDArray}}

  The same as :func:`load_data!`, except that this is for loading labels.
</code></pre>

<p><a target='_blank' href='https://github.com/dmlc/MXNet.jl/tree/8058ff77e2cf7c5f9ea8d7afc6de21ca71509a7f/src/io.jl#L121-186' class='documenter-source'>source</a><br></p>
<p><a id='MXNet.mx.AbstractDataProvider' href='#MXNet.mx.AbstractDataProvider'>#</a>
<strong><code>MXNet.mx.AbstractDataProvider</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>AbstractDataProvider
</code></pre>

<p>The root type for all data provider. A data provider should implement the following interfaces:</p>
<pre><code>   get_batch_size(provider) -&gt; Int

  :param AbstractDataProvider provider: the data provider.
  :return: the mini-batch size of the provided data. All the provided data should have the
           same mini-batch size (i.e. the last dimension).

   provide_data(provider) -&gt; Vector{Tuple{Base.Symbol, Tuple}}

  :param AbstractDataProvider provider: the data provider.
  :return: a vector of (name, shape) pairs describing the names of the data it provides, and
           the corresponding shapes.

   provide_label(provider) -&gt; Vector{Tuple{Base.Symbol, Tuple}}

  :param AbstractDataProvider provider: the data provider.
  :return: a vector of (name, shape) pairs describing the names of the labels it provides, and
           the corresponding shapes.
</code></pre>

<p>The difference between <em>data</em> and <em>label</em> is that during    training stage, both <em>data</em> and <em>label</em> will be feeded into the model, while during    prediction stage, only <em>data</em> is loaded. Otherwise, they could be anything, with any names, and    of any shapes. The provided data and label names here should match the input names in a target    :class:<code>SymbolicNode</code>.</p>
<p>A data provider should also implement the Julia iteration interface, in order to allow iterating    through the data set. The provider will be called in the following way:</p>
<p>.. code-block:: julia</p>
<pre><code>  for batch in eachbatch(provider)
    data = get_data(provider, batch)
  end
</code></pre>

<p>which will be translated by Julia compiler into</p>
<p>.. code-block:: julia</p>
<pre><code>  state = Base.start(eachbatch(provider))
  while !Base.done(provider, state)
    (batch, state) = Base.next(provider, state)
    data = get_data(provider, batch)
  end
</code></pre>

<p>By default, :func:<code>eachbatch</code> simply returns the provider itself, so the iterator interface    is implemented on the provider type itself. But the extra layer of abstraction allows us to    implement a data provider easily via a Julia $Task$ coroutine. See the    data provider defined in :doc:<code>the char-lstm example    &lt;/tutorial/char-lstm&gt;</code> for an example of using coroutine to define data    providers.</p>
<p>The detailed interface functions for the iterator API is listed below:</p>
<pre><code>Base.eltype(provider) -&gt; AbstractDataBatch
</code></pre>

<p>:param AbstractDataProvider provider: the data provider.    :return: the specific subtype representing a data batch. See :class:<code>AbstractDataBatch</code>.</p>
<pre><code>Base.start(provider) -&gt; AbstractDataProviderState
</code></pre>

<p>:param AbstractDataProvider provider: the data provider.</p>
<p>This function is always called before iterating into the dataset. It should initialize    the iterator, reset the index, and do data shuffling if needed.</p>
<pre><code>Base.done(provider, state) -&gt; Bool
</code></pre>

<p>:param AbstractDataProvider provider: the data provider.    :param AbstractDataProviderState state: the state returned by :func:<code>Base.start</code> :func:<code>Base.next</code>.    :return: true if there is no more data to iterate in this dataset.</p>
<pre><code>Base.next(provider) -&gt; (AbstractDataBatch, AbstractDataProviderState)
</code></pre>

<p>:param AbstractDataProvider provider: the data provider.    :return: the current data batch, and the state for the next iteration.</p>
<p>Note sometimes you are wrapping an existing data iterator (e.g. the built-in libmxnet data iterator) that is built with a different convention. It might be difficult to adapt to the interfaces stated here. In this case, you can safely assume that</p>
<ul>
<li>:func:<code>Base.start</code> will always be called, and called only once before the iteration starts.</li>
<li>:func:<code>Base.done</code> will always be called at the beginning of every iteration and always be called once.</li>
<li>If :func:<code>Base.done</code> return true, the iteration will stop, until the next round, again, starting with a call to :func:<code>Base.start</code>.</li>
<li>:func:<code>Base.next</code> will always be called only once in each iteration. It will always be called after one and only one call to :func:<code>Base.done</code>; but if :func:<code>Base.done</code> returns true, :func:<code>Base.next</code> will not be called.</li>
</ul>
<p>With those assumptions, it will be relatively easy to adapt any existing iterator. See the implementation of the built-in :class:<code>MXDataProvider</code> for example.</p>
<p>.. caution::</p>
<p>Please do not use the one data provider simultaneously in two different places, either in parallel,    or in a nested loop. For example, the behavior for the following code is undefined</p>
<p>.. code-block:: julia</p>
<pre><code>  for batch in data
    # updating the parameters

    # now let's test the performance on the training set
    for b2 in data
      # ...
    end
  end
</code></pre>

<p><a target='_blank' href='https://github.com/dmlc/MXNet.jl/tree/8058ff77e2cf7c5f9ea8d7afc6de21ca71509a7f/src/io.jl#L1-111' class='documenter-source'>source</a><br></p>
<p><a id='MXNet.mx.AbstractDataProviderState' href='#MXNet.mx.AbstractDataProviderState'>#</a>
<strong><code>MXNet.mx.AbstractDataProviderState</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>AbstractDataProviderState
</code></pre>

<p>Base type for data provider states.</p>
<p><a target='_blank' href='https://github.com/dmlc/MXNet.jl/tree/8058ff77e2cf7c5f9ea8d7afc6de21ca71509a7f/src/io.jl#L114-118' class='documenter-source'>source</a><br></p>
<p><a id='MXNet.mx.ArrayDataProvider' href='#MXNet.mx.ArrayDataProvider'>#</a>
<strong><code>MXNet.mx.ArrayDataProvider</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>ArrayDataProvider
</code></pre>

<p>A convenient tool to iterate :class:<code>NDArray</code> or Julia $Array$.</p>
<p><a target='_blank' href='https://github.com/dmlc/MXNet.jl/tree/8058ff77e2cf7c5f9ea8d7afc6de21ca71509a7f/src/io.jl#L257-261' class='documenter-source'>source</a><br></p>
<p><a id='MXNet.mx.ArrayDataProvider-Tuple{Any}' href='#MXNet.mx.ArrayDataProvider-Tuple{Any}'>#</a>
<strong><code>MXNet.mx.ArrayDataProvider</code></strong> &mdash; <em>Method</em>.</p>
<pre><code>ArrayDataProvider(data[, label]; batch_size, shuffle, data_padding, label_padding)
</code></pre>

<p>Construct a data provider from :class:<code>NDArray</code> or Julia Arrays.</p>
<p>:param data: the data, could be</p>
<pre><code>      - a :class:`NDArray`, or a Julia Array. This is equivalent to ``:data =&gt; data``.
      - a name-data pair, like ``:mydata =&gt; array``, where ``:mydata`` is the name of the data
        and ``array`` is an :class:`NDArray` or a Julia Array.
      - a list of name-data pairs.
</code></pre>

<p>:param label: the same as the $data$ parameter. When this argument is omitted, the constructed           provider will provide no labels.    :param Int batch_size: the batch size, default is 0, which means treating the whole array as a           single mini-batch.    :param Bool shuffle: turn on if the data should be shuffled at every epoch.    :param Real data_padding: when the mini-batch goes beyond the dataset boundary, there might           be less samples to include than a mini-batch. This value specify a scalar to pad the           contents of all the missing data points.    :param Real label_padding: the same as $data_padding$, except for the labels.</p>
<p>TODO: remove $data_padding$ and $label_padding$, and implement rollover that copies    the last or first several training samples to feed the padding.</p>
<p><a target='_blank' href='https://github.com/dmlc/MXNet.jl/tree/8058ff77e2cf7c5f9ea8d7afc6de21ca71509a7f/src/io.jl#L277-301' class='documenter-source'>source</a><br></p>
<p><a id='MXNet.mx.DataBatch' href='#MXNet.mx.DataBatch'>#</a>
<strong><code>MXNet.mx.DataBatch</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>DataBatch
</code></pre>

<p>A basic subclass of :class:<code>AbstractDataBatch</code>, that implement the interface by    accessing member fields.</p>
<p><a target='_blank' href='https://github.com/dmlc/MXNet.jl/tree/8058ff77e2cf7c5f9ea8d7afc6de21ca71509a7f/src/io.jl#L189-194' class='documenter-source'>source</a><br></p>
<p><a id='MXNet.mx.MXDataProvider' href='#MXNet.mx.MXDataProvider'>#</a>
<strong><code>MXNet.mx.MXDataProvider</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>MXDataProvider
</code></pre>

<p>A data provider that wrap built-in data iterators from libmxnet. See below for a list of built-in data iterators.</p>
<p><a target='_blank' href='https://github.com/dmlc/MXNet.jl/tree/8058ff77e2cf7c5f9ea8d7afc6de21ca71509a7f/src/io.jl#L450-455' class='documenter-source'>source</a><br></p>
<p><a id='MXNet.mx.SlicedNDArray' href='#MXNet.mx.SlicedNDArray'>#</a>
<strong><code>MXNet.mx.SlicedNDArray</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>SlicedNDArray
</code></pre>

<p>A alias type of $Tuple{UnitRange{Int},NDArray}$.</p>
<p><a target='_blank' href='https://github.com/dmlc/MXNet.jl/tree/8058ff77e2cf7c5f9ea8d7afc6de21ca71509a7f/src/io.jl#L204-208' class='documenter-source'>source</a><br></p>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../metric/" title="Evaluation Metrics">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Evaluation Metrics
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../ndarray/" title="NDArray API">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                NDArray API
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'dmlc/MXNet.jl';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.jl?config=TeX-AMS-MML_HTMLorMML"></script>
    
      <script src="../../assets/mathjaxhelper.js"></script>
    
    
  </body>
</html>